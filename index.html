<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CoinRush Airdrop</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: #0c0c0c;
      color: #fff;
    }
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1em;
      background: #111;
    }
    header img {
      height: 40px;
    }
    .balance {
      font-size: 18px;
      font-weight: bold;
    }
    main {
      padding: 2em;
      text-align: center;
    }
    h1 {
      font-size: 28px;
    }
    button {
      background: #FFAB00;
      border: none;
      color: #000;
      padding: 0.7em 1.5em;
      margin: 0.5em;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
    }
    .wheel-container {
      margin-top: 20px;
      display: none;
      flex-direction: column;
      align-items: center;
    }
    .referral {
      margin-top: 1em;
      font-size: 14px;
      word-break: break-word;
    }
  </style>
</head>
<body>
  <header>
    <img src="logo.png" alt="CoinRush Logo" />
    <div class="balance" id="balance">Balance: 0 $CRT</div>
  </header>

  <main>
    <h1>Welcome to CoinRush Airdrop</h1>
    <p id="greeting">Fetching your Telegram info...</p>

    <button onclick="claimLogin()">Daily Login</button>
    <button onclick="startMining()">Mine Tokens</button>

    <div class="wheel-container" id="wheelContainer">
      <p>Spin the wheel! You have <span id="spinsLeft">5</span> spins left today.</p>
      <button onclick="spinWheel()">üé° Spin</button>
      <div id="spinResult"></div>
    </div>

    <div class="referral">
      <p>Your referral link:</p>
      <code id="referralLink">Generating...</code>
    </div>
  </main>

  <script>
    let balance = 0;
    let spinsLeft = 5;

    const telegram = window.Telegram.WebApp;
    telegram.ready();

    let username = "";
    let accountAge = 0;

    function init() {
      const initData = telegram.initDataUnsafe;
      username = initData?.user?.username || "guest";
      const createdAt = initData?.user?.created_at;
      
      if (createdAt) {
        const createdDate = new Date(createdAt * 1000);
        const now = new Date();
        const years = now.getFullYear() - createdDate.getFullYear();
        accountAge = years;
        const baseTokens = years * 1000;
        updateBalance(baseTokens);
        document.getElementById("greeting").innerText = `Hello @${username} üëã\nYou‚Äôve been on Telegram for ${years} year(s)! You‚Äôve earned ${baseTokens} $CRT.`;
      } else {
        document.getElementById("greeting").innerText = `Hello üëã You‚Äôre not logged in via Telegram.`;
      }

      const referralLink = `https://t.me/CR_Token_bot?start=${username}`;
      document.getElementById("referralLink").innerText = referralLink;
    }

    function updateBalance(amount) {
      balance += amount;
      document.getElementById("balance").innerText = `Balance: ${balance} $CRT`;
    }

    function claimLogin() {
      const lastClaim = localStorage.getItem("lastClaim");
      const now = Date.now();
      if (!lastClaim || now - lastClaim > 86400000) {
        updateBalance(200);
        localStorage.setItem("lastClaim", now);
        alert("‚úÖ You‚Äôve claimed your daily login reward!");
      } else {
        alert("‚è≥ Come back in 24 hours to claim again!");
      }
    }

    function startMining() {
      document.getElementById("wheelContainer").style.display = "flex";
    }

    function spinWheel() {
      if (spinsLeft <= 0) {
        alert("No spins left today!");
        return;
      }

      spinsLeft--;
      document.getElementById("spinsLeft").innerText = spinsLeft;

      const rewards = [50, 100, 200, 500, 0];
      const result = rewards[Math.floor(Math.random() * rewards.length)];

      updateBalance(result);
      document.getElementById("spinResult").innerText = `You won ${result} $CRT!`;
    }

    window.onload = init;
  </script>
</body>
</html>
