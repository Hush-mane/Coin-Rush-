<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF‚Äë8" />
  <meta name="viewport" content="width=device‚Äëwidth,initial‚Äëscale=1.0"/>
  <title>CoinRush</title>
  <style>
    /* Global styles */
    body {
      margin: 0;
      padding: 0;
      background: #121212;
      color: #fff;
      font-family: 'Segoe UI', sans-serif;
      overflow: hidden;
    }
    header {
      display: flex;
      justify-content: space-between;
      padding: 15px 20px;
      background: #1f1f1f;
      font-size: 18px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.4);
    }
    header h1 { margin: 0; }
    .balance {
      font-weight: bold;
    }
    .tabs {
      display: flex;
      justify-content: space-around;
      background: #272727;
    }
    .tab-btn {
      flex: 1;
      padding: 12px;
      background: none;
      border: none;
      color: #fff;
      font-size: 16px;
      cursor: pointer;
      transition: background 0.3s;
    }
    .tab-btn:hover, .tab-btn.active {
      background: #333;
    }
    .screen {
      display: none;
      position: relative;
      height: calc(100vh - 106px); /* header + tabs height */
      width: 100%;
    }
    .screen.active {
      display: block;
    }

    /* Home Screen */
    #home {
      padding: 20px;
      background: #181818;
    }
    .task-btn {
      width: 100%;
      padding: 12px;
      margin: 8px 0;
      font-size: 16px;
      border: none;
      border-radius: 8px;
      background: #00aaff;
      color: #121212;
      cursor: pointer;
      transition: transform 0.2s ease, background 0.2s;
    }
    .task-btn:hover {
      transform: scale(1.02);
      background: #0091cc;
    }

    /* Game Screen */
    #game {
      background: #111;
    }
    canvas {
      position: absolute;
      top: 0;
      width: 100%;
      height: 100%;
    }
    .hud {
      position: absolute;
      top: 10px;
      left: 10px;
      display: flex;
      gap: 16px;
      font-size: 16px;
      background: rgba(0,0,0,0.3);
      padding: 8px;
      border-radius: 8px;
    }
    .shake {
      animation: shake 0.4s;
    }
    @keyframes shake {
      0%,100% { transform: translateX(0); }
      10%,30%,50%,70%,90% { transform: translateX(-8px); }
      20%,40%,60%,80% { transform: translateX(8px); }
    }
  </style>
</head>
<body>
  <header>
    <h1>CoinRush</h1>
    <div class="balance">üí∞ <span id="balance">0</span> CR</div>
  </header>

  <div class="tabs">
    <button class="tab-btn active" onclick="switchTab('home')">Home</button>
    <button class="tab-btn" onclick="switchTab('game')">Play üéÆ</button>
  </div>

  <!-- Home Screen -->
  <div id="home" class="screen active">
    <div style="padding:20px;">
      <button class="task-btn" onclick="openLink('https://t.me/+XBybK8ySpu84ZjM0')">Join Telegram Group</button>
      <button class="task-btn" onclick="openLink('https://x.com/CRUSH_Tokenn')">Follow on X</button>
      <button class="task-btn" onclick="openLink('https://t.me/yourchannel/1')">Like Telegram Post</button>
      <button class="task-btn" onclick="openLink('https://x.com/yourpost')">Like & Retweet on X</button>
      <button class="task-btn" onclick="copyReferral()">Copy Referral Link</button>
    </div>
  </div>

  <!-- Game Screen -->
  <div id="game" class="screen">
    <canvas id="gameCanvas"></canvas>
    <div class="hud">
      <div>‚è≥ <span id="timer">30</span>s</div>
      <div>ü™ô <span id="coins">0</span></div>
    </div>
  </div>

<script>
let balance = parseInt(localStorage.getItem('cr_balance')||0);
let coinsCollected = 0;
let timer=30, gameActive=false, played=false;

const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight-106; 
const timerEl = document.getElementById('timer');
const coinsEl = document.getElementById('coins');
const balanceEl = document.getElementById('balance');

function switchTab(tab) {
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
  document.getElementById(tab).classList.add('active');
  document.querySelector(`[onclick*="${tab}"]`).classList.add('active');
  if(tab==='game' && !played) startGame();
}

// Task linking
function openLink(url){
  window.open(url, '_blank');
}

// Copy referral
function copyReferral(){
  const link=`https://t.me/CR_Token_bot/Coinrush?start=ref${Date.now()}`;
  navigator.clipboard.writeText(link).then(()=>alert('Referral link copied!'));
}

// Gameplay
const items=[];
function spawn(){
  if(!gameActive) return;
  const type=Math.random()<0.8?'coin':'bomb';
  items.push({
    x:Math.random()*(canvas.width-40), y:-40, type
  });
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  items.forEach((it,i)=>{
    it.y += typeSpeed(it.type);
    ctx.drawImage(getImg(it.type), it.x, it.y,40,40);
    if(it.y>canvas.height) items.splice(i,1);
  });
  requestAnimationFrame(draw);
}

function typeSpeed(t) {
  return t==='coin'?Math.random()*4+2:Math.random()*3+2;
}

const imgCoin=new Image(); imgCoin.src='https://i.imgur.com/dzJiG5e.png';
const imgBomb=new Image(); imgBomb.src='https://i.imgur.com/UuQ7rUI.png';
function getImg(t){ return t==='coin'?imgCoin:imgBomb; }

canvas.onclick=(e)=>{
  if(!gameActive) return;
  const rx=e.clientX, ry=e.clientY;
  items.forEach((it,i)=>{
    if(Math.hypot(it.x+20-rx,it.y+20-ry)<20){
      if(it.type==='coin'){
        coinsCollected++;
        coinsEl.textContent=coinsCollected;
      } else {
        coinsCollected = Math.max(0, coinsCollected-5);
        coinsEl.textContent=coinsCollected;
        document.getElementById('game').classList.add('shake');
        setTimeout(()=>document.getElementById('game').classList.remove('shake'),400);
      }
      items.splice(i,1);
    }
  });
}

function startGame(){
  gameActive=true;
  coinsCollected=0; timer=30;
  coinsEl.textContent=0; timerEl.textContent=30;
  played=true;
  
  const spawnInt = setInterval(spawn,300);
  const tick = setInterval(()=>{
    timer--;
    timerEl.textContent=timer;
    if(timer<=0){
      clearInterval(tick); clearInterval(spawnInt);
      gameActive=false;
      balance += coinsCollected;
      localStorage.setItem('cr_balance', balance);
      balanceEl.textContent = balance;
      alert('Game over! You earned ' + coinsCollected + ' CR');
    }
  },1000);
  draw();
}

balanceEl.textContent = balance;
</script>
</body>
</html>
